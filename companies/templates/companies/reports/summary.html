{% extends "page_base.html" %}

{% load i18n %}
{% load entrak_extras %}
{% load static %}
{% load humanize %}

{% block ga_page_title %}report{% endblock %}

{% block extra_head %}
{{block.super}}
{% get_current_language as LANGUAGE_CODE %}

<link rel="stylesheet" type="text/css" href="{% static 'css/drop-down-panel.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/summary_report.css' %}">

<script src="{% static 'js/jquery-cookie-master/jquery.cookie.js' %}"></script>
<script src="{% static 'js/csrf_ajax.js' %}"></script>
<script src="{% static 'js/moment-with-locales.js' %}"></script>
<script src="{% static 'js/moment-timezone-with-data.min.js' %}"></script>
<script src="{% static 'js/entrak-system.js' %}"></script>
<script src="{% static 'js/entrak-utils.js' %}"></script>
<script src="{% static 'js/report-generator.js' %}"></script>

<link href="{% static 'assets/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
<link href="{% static 'assets/kendoui/styles/kendo.common.min.css' %}" rel="stylesheet">
<link href="{% static 'assets/kendoui/styles/kendo.default.min.css' %}" rel="stylesheet">
<!-- Because now using jquery v1.11 -->
<script src="{% static 'assets/kendoui/js/angular.min.js' %}"></script>
<script src="{% static 'assets/kendoui/js/kendo.all.min.js' %}"></script>

<script src="{% static 'assets/etkendoui/js/et.datepicker.js' %}"></script>

<!-- hack for combining bootstrap -->
<style>
  #menu-links li:hover, #menu-links li.menu-links-selected {
     height: auto;
  }

  .panel-header-left-menu h3 {
    margin: 0;
    height: 33px;
  }

</style>

<style>
  .report-summary .time-type {
    color: #44586a;
    font-weight: 600;
    font-size: 3 rem;
    padding: 25px 0;
    border-bottom: #e8ebeb solid 3px;
  }

  .report-summary .col-xs-3 {
    background-color: white;
    border-left: #e8ebeb solid 3px;
  }

  .report-summary img.icon {
    padding: 20px;
    height: 120px;
    width: 120px;
  }
</style>

<script type="text/javascript">
// put here to share with extended template
var report = {};
report.reportGeneratorMultiLangTexts = {
    'reportTypeMonthDtFormat': '{% trans "MMM YYYY" %}',
    'reportTypeYearDtFormat': '{% trans "YYYY" %}',
    'reportTypeCustomMonthDtFormat': '{% trans "D MMM YYYY, ddd" %}',
    'reportTypeWeekDtFormat': '{% trans "D MMM YYYY, ddd" %}',
    'genDtTo': '{% trans " to " %}',
    'tons': '{% trans " tons" %}',
    'tonsCo2': '{% blocktrans %} tons<span class="basic-info-col-unit"> CO<sub>2</sub></span>{% endblocktrans %}',
    'reportTypeNameMonth': '{% trans "report_type_name_month" %}',
    'reportTypeNameYear': '{% trans "report_type_name_year" %}',
    'reportTypeNameQuarter': '{% trans "report_type_name_quarter" %}',
    'reportTypeNameWeek': '{% trans "report_type_name_week" %}',
    'more': '{% trans "more" %}',
    'less': '{% trans "less" %}',
    'overall': '{% trans "Overall: " %}',
    'calendarMore': '{% trans "calendar_more" %}',
    'calendarLess': '{% trans "calendar_less" %}',
    'comparedTo': '{% trans "compared<br>to " %}',
    'mSquare': '{% trans " mÂ²" %}',
    'pandas': '{% trans " pandas" %}',
    'beginDtFormat': '{% trans "MMMM YYYY" %}',
    'lastMonth': '{% trans "last month" %}',
    'last_week': '{% trans "last week" %}',
    'samePeriodLastYear': '{% trans "same period last year" %}',
    'calendarUsageDtFormat': '{% trans "D MMM YYYY" %}',
    'calendarTypeWeekday': '{% trans "Weekday" %}',
    'calendarTypeWeekend': '{% trans "Weekend" %}',
    'calendarTypeOvernight': '{% trans "Overnight" %}',
    'calendarSplitWeekdays': '{% trans "Weekdays" %}',
    'calendarSplitWeekends': '{% trans "Weekends" %}',
    'calendarSplitDaytime': '{% trans "Daytime" %}',
    'calendarSplitOvernight': '{% trans "Overnight" %}',
    'overnightFootnoteFormat': '{% trans "hh:mmA" %}',
    'comparePastLabelFormat': '{% trans "MMM D" %}',
};

</script>
{% endblock %}

{% block selected-menu-link-id %}menu-link-report{% endblock %}
{% block system_menu_target_view %}report{% endblock %}
{% block breadcrumb_target_view %}report{% endblock %}

{% block page_title %}{% trans "THE REPORTS PAGE" %}{% endblock %}
{% block page_subtitle %}{% trans "Get all your information here at the" %}{% endblock %}

{% block extra_script %}
{{block.super}}
{% get_current_language as LANGUAGE_CODE %}

{% include "report_inner_template.html" %}

<script>

function updateReportName() {
    $(".report-name").text(report.reportGenerator.genReportName());
}

function updateBoundDt() {
    if (report.currentReportType === ReportGenerator.REPORT_TYPE_YEAR) {
        if (report.firstRecord.month() === 0 && report.firstRecord.date() === 1) {
            report.boundStartDt = moment(report.firstRecord).startOf('year');
        } else {
            report.boundStartDt = moment(report.firstRecord).add(1, 'y').startOf('year');
        }

        report.boundEndDt = moment().tz(report.timezone).startOf('year');
    } else if (report.currentReportType === ReportGenerator.REPORT_TYPE_QUARTER) {
        if (report.firstRecord.date() === 1
            && (report.firstRecord.month() === 0 || report.firstRecord.month() === 3
                || report.firstRecord.month() === 6 || report.firstRecord.month() === 9)) {
            report.boundStartDt = moment(report.firstRecord).startOf('quarter');
        } else {
            report.boundStartDt = moment(report.firstRecord).add(3, 'M').startOf('quarter');
        }

        report.boundEndDt = moment().tz(report.timezone).startOf('quarter');
    } else if (report.currentReportType === ReportGenerator.REPORT_TYPE_WEEK) {
        if (report.firstRecord.day() === 0) {
            report.boundStartDt = moment(report.firstRecord).startOf('week');
        } else {
            report.boundStartDt = moment(report.firstRecord).add(1, 'w').startOf('week');
        }

        report.boundEndDt = moment().tz(report.timezone).startOf('week');
    }
}



function selectWholeWeek() {
    window.setTimeout(function () {
        $('#week-datepicker').find('.ui-datepicker-current-day a').addClass('ui-state-active')
    }, 1);
}

function setWeekHoverEffect() {
    window.setTimeout(function () {
        $('#week-datepicker .ui-datepicker-calendar tr').on("mousemove", function() {
            $(this).find('td a').addClass('ui-state-hover');
        });
        $('#week-datepicker .ui-datepicker-calendar tr').on("mouseleave", function() {
            $(this).find('td a').removeClass('ui-state-hover');
        });
    }, 1);
}

function timeRangeWeekSelected() {
    var weekStartDate, weekEndDate;
    $("#week-datepicker").datepicker('destroy');
    $("#week-datepicker").datepicker({
        showOtherMonths: true,
        selectOtherMonths: true,
        minDate: report.boundStartDt.toDate(),
        maxDate: moment(report.boundEndDt).subtract(1, 'd').toDate(),
        onSelect: function(dateText, inst) {
            var selectDt = moment($(this).datepicker('getDate')).startOf('week');
            weekStartDate = selectDt.toDate();
            weekEndDate = moment(selectDt).endOf('week').toDate();
            selectWholeWeek();

            report.currentDt = selectDt;
            updateGenReportSection();
            setWeekHoverEffect();
        },
        beforeShowDay: function(date) {
            var cssClass = '';
            if(date >= weekStartDate && date <= weekEndDate) {
                cssClass = 'ui-datepicker-current-day';
            }
            return [true, cssClass];
        },
        onChangeMonthYear: function(year, month, inst) {
            selectWholeWeek();
            setWeekHoverEffect();
        }
    });

    setWeekHoverEffect();
}

function updateGenReportSection() {
    var fromText, toText;
    if (report.currentReportType === ReportGenerator.REPORT_TYPE_YEAR) {
        fromText = report.currentDt.format('{% trans "YYYY" %}');
        toText = report.reportGenerator.genEndDt(report.currentDt, report.currentReportType).format('{% trans "YYYY" %}');
    } else if (report.currentReportType === ReportGenerator.REPORT_TYPE_QUARTER) {
        fromText = report.currentDt.format('{% trans "YYYY MMMM" %}');
        toText = report.reportGenerator.genEndDt(report.currentDt, report.currentReportType).format('{% trans "YYYY MMMM" %}');
    } else if (report.currentReportType === ReportGenerator.REPORT_TYPE_CUSTOM_MONTH) {
        fromText = moment($("#month-start-datepicker").datepicker("getDate")).format('{% trans "D MMM YYYY, ddd" %}');
        toText = moment($("#month-end-datepicker").datepicker("getDate")).format('{% trans "D MMM YYYY, ddd" %}');
    } else if (report.currentReportType === ReportGenerator.REPORT_TYPE_WEEK) {
        fromText = report.currentDt.format('{% trans "D MMM YYYY, ddd" %}');
        toText = moment(report.currentDt).add(1, 'w').format('{% trans "D MMM YYYY, ddd" %}');
    }
    $(".datetime-result .from-date").text(fromText);
    $(".datetime-result .to-date").text(toText);

    updateCreateBtnStatus();
}

function updateCreateBtnStatus() {
    var createBtnEnable = canCreateCustomReport();

    if (createBtnEnable) {
        $(".create-report-btn").removeClass("btn-disable");
    } else {
        $(".create-report-btn").addClass("btn-disable");
    }
}

function dlRawDataSelected() {
    $(".datetime-result .from-date").text('');
    $(".datetime-result .to-date").text('');
    $(".create-report-btn").addClass("btn-disable");

    $('.unit-container>span').removeClass('selected-unit')
    $('.unit-container>span:eq(0)').addClass('selected-unit');

    report.dlRawDataStartDt = null;
    report.dlRawDataEndDt = null;
    report.dlRawDataUnit = 'kwh';

    $("#download-raw-data .report-datepicker").datepicker('destroy');
    $("#dl-data-start-datepicker").datepicker({
        minDate: report.firstRecord.toDate(),
        maxDate: '-1d',
        onSelect: function(dateText, inst) {
            var selectDt = moment($(this).datepicker('getDate')).tz(report.timezone);
            var boundMinDate = moment(selectDt).add(1, 'd').toDate();
            $("#dl-data-end-datepicker").datepicker("option", "minDate", boundMinDate);

            if (report.dlRawDataEndDt !== null
                && (selectDt.isSame(report.dlRawDataEndDt)) || selectDt.isAfter(report.dlRawDataEndDt)) {
                var endDt = moment($("#dl-data-end-datepicker").datepicker('getDate')).tz(report.timezone);
                report.dlRawDataEndDt = endDt;
                $(".datetime-result .to-date").text(endDt.format('{% trans "D MMM YYYY, ddd" %}'));
            }

            report.dlRawDataStartDt = selectDt;
            $(".datetime-result .from-date").text(selectDt.format('{% trans "D MMM YYYY, ddd" %}'));

            updateDlRawBtnStatus();
        },
    });
    $("#dl-data-end-datepicker").datepicker({
        minDate: report.firstRecord.toDate(),
        maxDate: '0d',
        onSelect: function(dateText, inst) {
            var selectDt = moment($(this).datepicker('getDate')).tz(report.timezone);
            report.dlRawDataEndDt = selectDt;
            $(".datetime-result .to-date").text(selectDt.format('{% trans "D MMM YYYY, ddd" %}'));

            updateDlRawBtnStatus();
        },
    });
}

function canDlRawData() {
    return (report.dlRawDataStartDt !== null
        && report.dlRawDataEndDt !== null
        && report.dlRawDataEndDt.isAfter(report.dlRawDataStartDt))
}

function updateDlRawBtnStatus() {
    if (canDlRawData()) {
        $(".create-report-btn").removeClass("btn-disable");
    } else {
        $(".create-report-btn").addClass("btn-disable");
    }
}

function setDetailShow(isShow) {
    if (isShow) {
        $(".hide-details-btn").removeClass('btn-down');
        $(".detail-container").show();
    } else {
        $(".hide-details-btn").addClass('btn-down');
        $(".detail-container").hide();
    }
}

$(function() {
    setupAjaxForCsrf($.cookie('csrftoken'));
    report.langCode = '{{LANGUAGE_CODE}}';
    moment.locale(report.langCode);

    report.entrakSystem = new EntrakSystem();
    report.entrakSystem.langCode = report.langCode;
    report.entrakSystem.assignSystemTree('{{systems|jsonifySystems}}');

    report.currentReportType = ReportGenerator.REPORT_TYPE_MONTH;
    report.timezone = '{{systems.0.timezone}}';
    report.firstRecord = moment.unix(report.entrakSystem.systemTree.data.firstRecord).tz(report.timezone);
    {% if monthly_summary|length >= 1 %}
    report.currentDt =  moment.unix({{monthly_summary.0.timestamp}}).tz(report.timezone);
    {% endif %}

    $(".report-component").css("opacity", 0.0);

    report.reportGenerator = new ReportGenerator(report.entrakSystem.systemTree, report.timezone,
        ReportGenerator.REPORT_TYPE_MONTH, report.reportGeneratorMultiLangTexts);
    report.reportGenerator.langCode = '{{LANGUAGE_CODE}}';
    if ("currentDt" in report) {
        report.reportGenerator.updateDtInfo(report.currentDt, null);
        updateReportName();

        report.reportGenerator.getReportData(function(data) {
            report.reportGenerator.assignData(data);
            setDetailShow(true);
            report.reportGenerator.generateFullReport();
            setDetailShow(false);
            $(".report-component").fadeTo(600, 1.0);
        });
    }

    $(".panel-header-left-menu h3").each(function(btnIdx) {
        $(this).click({btnIdx: btnIdx}, function(event) {
            var btnIdx = event.data.btnIdx;

            $(".panel-header-left-menu h3").removeClass('selected-tab');
            $(this).addClass('selected-tab');

            var panelContentHeight;
            if (btnIdx === 0) {
                panelContentHeight = '162px';
            } else if (btnIdx === 1) {
                panelContentHeight = '608px';
                dlRawDataSelected();
            }
            $("#panel-content").css("height", panelContentHeight);

            var targetPanel = $($('#panel-content>div')[btnIdx]);
            if (targetPanel.css("display") == 'none') {
                $('#panel-content>div').fadeOut();
                targetPanel.fadeIn();
            }
        });
    });
    $(".panel-header-left-menu h3:eq(0)").click();


    $(".unit-container>span").each(function(btnIdx) {
        $(this).click({btnIdx: btnIdx}, function(event) {
            var btnIdx = event.data.btnIdx;
            if (btnIdx === 0) {
                report.dlRawDataUnit = 'kwh';
            } else if (btnIdx === 1) {
                report.dlRawDataUnit = 'money';
            } else if (btnIdx === 2) {
                report.dlRawDataUnit = 'co2';
            } else if (btnIdx === 3) {
                report.dlRawDataUnit = 'all';
            }

            $(".unit-container>span").removeClass('selected-unit');
            $(this).addClass('selected-unit');
        });
    });

    $("#download-raw-data .create-report-btn").click(function() {
        if (canDlRawData()) {
            $(".download-raw-data-form input[name='start_timestamp']").attr("value", report.dlRawDataStartDt.unix());
            $(".download-raw-data-form input[name='end_timestamp']").attr("value", report.dlRawDataEndDt.unix());
            $(".download-raw-data-form input[name='unit']").attr("value", report.dlRawDataUnit);
            $(".download-raw-data-form").submit();
        }
    });
});
</script>
{% endblock %}

{% block page_content %}

    <div ng-app="Entrak">
    <div ng-controller="ReportController" xng-init="init()" class="container">
        <button ng-click="win2.close()" ng-show="win2visible">close</button>
        <div kendo-window="win_report" k-visible="false" k-iframe="true"
             k-width="1200" k-height="5000" k-modal="true"
             >
        </div>


<div class="summary">
    <div class="row drop-down-panel-header">
        <div class="panel-header-left-menu">
            <h3 panel="monthly-report">
                {% trans "Monthly Report" %}</h3>
            <h3 panel="download-data">{% trans "Download Data" %}</h3>
        </div>
    </div>
    <div id="panel-content">
        <div id="monthly-report">
          <div class="report-summary text-center">
    <div class="time-bar row text-left">
      <div class="col-xs-12">
        <p>
          <div kendo-toolbar k-options="timeToolbarOptions" k-on-toggle="selectTimeType(kendoEvent)"></div>
        </p>
      </div>

    </div>

  <div class="row">
    <div class="col-xs-3">
      <div class="row time-type"><div class="col-xs-12">
          Monthly
      </div></div>
      <div class="row content"><div class="col-xs-12">
          <img alt="power" class="icon" src="{% static 'images/report/lightning-energy.png' %}">
          <h3>{% templatetag openvariable %} summary_report.formated_total_cost || default_null {% templatetag closevariable %}</h3>
          <p>total energy cost</p>
      </div></div>
      {% verbatim %}
      <div class="row content end"><div class="col-xs-12">
          <img alt="decrease enegry" class="icon" src="{{ summary_report.compare_to_last_total.icon_path }}">
          <h3>{{ summary_report.compare_to_last_total.formated_percent_change || default_null }}</h3>
          <p>compared to last month</p>
      </div></div>
      {% endverbatim %}
    </div>
    <div class="col-xs-3">
      <div class="row time-type"><div class="col-xs-12">
          Weekdays
      </div></div>
      <div class="row content"><div class="col-xs-12">
          <img alt="power" class="icon" src="{% static 'images/reports/calendar_energy_icon.svg' %}">
          <h3>{% templatetag openvariable %} summary_report.formated_weekday_cost || default_null {% templatetag closevariable %}</h3>
          <p>Average Weekdays Cost</p>
      </div></div>
      {% verbatim %}
      <div class="row content end"><div class="col-xs-12">
          <img alt="decrease enegry" class="icon" src="{{ summary_report.compare_to_last_weekdays.icon_path }}">
          <h3>{{ summary_report.compare_to_last_weekdays.formated_percent_change || default_null }}</h3>
          <p>Compared to last month</p>
      </div></div>
      {% endverbatim %}
    </div>
    <div class="col-xs-3">
      <div class="row time-type"><div class="col-xs-12">
          Overnight
      </div></div>
      <div class="row content"><div class="col-xs-12">
          <img alt="power" class="icon" src="{% static 'images/reports/calendar_energy_icon.svg' %}">
          <h3>{% templatetag openvariable %} summary_report.formated_overnight_avg_cost || default_null {% templatetag closevariable %}</h3>
          <p>Average Overnight Cost</p>
      </div></div>
      {% verbatim %}
      <div class="row content end"><div class="col-xs-12">
          <img alt="decrease enegry" class="icon" src="{{ summary_report.compare_to_last_overnight_avg_cost.icon_path }}">
          <h3>{{ summary_report.compare_to_last_overnight_avg_cost.formated_percent_change || default_null }}</h3>
          <p>Compared to last month</p>
      </div></div>
      {% endverbatim %}
    </div>
    <div class="col-xs-3">

      <div class="view-report">
        <img class="img-button" src="{% static "images/reports/view_report.svg" %}" ng-click="view_report()">
        <button class="k-button" ng-click="view_report()">View Full Report</button>
      </div>
    </div>
  </div>
  
</div>


        </div>


        <div id="download-raw-data">
            <div class="row dl-data-title">{% trans "Here you can download your energy use data to files in .csv format." %}</div>
            <div class="row dl-data-title">{% trans "Simply select the start date, end date and the units that you would like to obtain from the system." %}</div>
            <div class="row customize-section-title"><span>1</span>{% trans "Choose your date" %}</div>

            <div class="row dl-choose-date-section">
                <div class="report-datepicker-container">
                    <div>{% trans "Choose your start date" %}</div>
                    <div id="dl-data-start-datepicker" class="report-datepicker"></div>
                </div>
                <div class="report-datepicker-container">
                    <div>{% trans "Choose your end date" %}</div>
                    <div id="dl-data-end-datepicker" class="report-datepicker"></div>
                </div>
            </div>
            <div class="two-column-section row">
                <div class="choose-unit-section pull-left">
                    <div class="customize-section-title"><span>2</span>{% trans "Select your units" %}</div>
                    <div class="unit-container">
                        <span></span><span></span><span></span>
                    </div>
                </div>
                <div class="pull-left">
                    <div class="customize-section-title"><span>3</span>{% trans "Download your file" %}</div>
                    <div class="create-report-section">
                        <div class="datetime-result">
                            <div class="datetime-result-title">{% trans "Energy data - kWh" %}</div>
                            <div class="datetime-result-from-to">
                                <div><span>{% trans "From:" %}</span><span class="from-date"></span></div>
                                <div><span>{% trans "To:" %}</span><span class="to-date"></span></div>
                            </div>
                            <hr>
                            <div class="create-report-btn">{% trans "Download File" %}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<form class="download-pdf-form" action="{% url 'report_pdf' system_code=systems.0.code %}" method="POST">{% csrf_token %}
        <input name="start_timestamp" value="">
        <input name="end_timestamp" value="">
        <input name="report_type" value="">
        <input name="report_layout" value="">
</form>

<form class="download-raw-data-form" action="{% url 'export_data' system_code=systems.0.code %}" method="POST">{% csrf_token %}
        <input name="start_timestamp" value="">
        <input name="end_timestamp" value="">
        <input name="unit" value="">
</form>

</div></div>
<!-- end ng-app -->
<script>
    angular.module("Entrak", [ "kendo.directives" ])
        .controller("ReportController", function($scope){
            // var selected_time_type = "month";
            // var start_time;
            // var end_time;
            $scope.default_null = "N/A";

            $scope.view_report = function() {
                var date = $scope.report_date.value();
                var month_shortnames = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'];
                var month_shortname = month_shortnames[date.getMonth()];
                var year = date.getFullYear();
                $scope.win_report.refresh({ url: '../report/popup-report/' + year + '/' + month_shortname + '/'});
                $scope.win_report.open().center();
            }

            var summary_report_ds = new kendo.data.DataSource({
                transport: {
                    read: {
                        async: false,
                        url: "{% url 'companies.reports.summary.ajax' systems.0.code %}",
                        type: 'GET',
                        dataType: "json"
                    }
                },
                schema: {
                    // Fix for single result
                    data: function(response) {
                        return [response];
                    }
                }
            });

            summary_report_ds.read();
            $scope.summary_report = summary_report_ds.data()[0];

            $scope.selectTimeType = function (e) {
                var tb = e.sender;
                var selected = tb.getSelectedFromGroup('time');
                $scope.monthSelectorOptions.select = selected.attr('id');
            };

            $scope.timeToolbarOptions = {
                items: [
                    {
                      type: "buttonGroup",
                      buttons: [
                          { text: "Week", id: "week", togglable: true, group: "time"},
                          { text: "Month", id: "month", togglable: true, group: "time", selected: true },
                          { text: "Quarter", id: "quarter", togglable: true, group: "time" },
                          { text: "Year", id: "year", togglable: true, group: "time" }
                      ]
                    },
                    {
                        template: '<input kendo-et-date-picker="report_date" style="width: 220px;" k-on-change="on_date_selected(kendoEvent)" k-options="monthSelectorOptions" k-rebind="monthSelectorOptions" k-value="default_date" >',
                        overflow: "never"
                    }
                ]
            };

            $scope.monthSelectorOptions = {
                format: 'MMMM yyyy',
                select: "month",
                clickPopup: true
            }

            /*
            $scope.wtf = function() {
                summary_report_ds.read();
                return summary_report_ds.data();

            }*/
            $scope.on_date_selected = function(e) {
                var dp = e.sender;
                var start_date = dp.getSelectedStartDate();
                var end_date = dp.getSelectedEndDate();
                summary_report_ds.transport.options.read['data'] = {
                    start_date: kendo.toString(start_date, 'yyyy-MM-dd'),
                    end_date: kendo.toString(end_date, 'yyyy-MM-dd')
                };
                summary_report_ds.read();
                $scope.summary_report = summary_report_ds.data()[0];
            }

            $scope.default_date = new Date("{{ default_date.isoformat }}");
            // $scope.report_date

        })


</script>
{% endblock %}
